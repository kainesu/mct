<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-06-08">

<title>microbial culture technology - My experience applying for the F1 visa in Singapore</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">microbial culture technology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#timeline" id="toc-timeline" class="nav-link active" data-scroll-target="#timeline">Timeline</a></li>
  <li><a href="#total-cost-of-application" id="toc-total-cost-of-application" class="nav-link" data-scroll-target="#total-cost-of-application">Total cost of application</a></li>
  <li><a href="#applying-for-a-new-passport" id="toc-applying-for-a-new-passport" class="nav-link" data-scroll-target="#applying-for-a-new-passport">Applying for a new passport</a></li>
  <li><a href="#apply-for-i-20-form" id="toc-apply-for-i-20-form" class="nav-link" data-scroll-target="#apply-for-i-20-form">Apply for I-20 form</a></li>
  <li><a href="#complete-application-for-f1-visa-ds-160" id="toc-complete-application-for-f1-visa-ds-160" class="nav-link" data-scroll-target="#complete-application-for-f1-visa-ds-160">Complete application for F1 visa (DS-160)</a></li>
  <li><a href="#pay-for-i-90sevis-fee" id="toc-pay-for-i-90sevis-fee" class="nav-link" data-scroll-target="#pay-for-i-90sevis-fee">Pay for I-90/SEVIS fee</a></li>
  <li><a href="#apply-for-a-visa-interview-appointment-and-getting-an-interview-waiver" id="toc-apply-for-a-visa-interview-appointment-and-getting-an-interview-waiver" class="nav-link" data-scroll-target="#apply-for-a-visa-interview-appointment-and-getting-an-interview-waiver">Apply for a visa interview appointment (and getting an interview waiver)</a></li>
  <li><a href="#dropping-off-the-documents-at-the-aramex-courier-office" id="toc-dropping-off-the-documents-at-the-aramex-courier-office" class="nav-link" data-scroll-target="#dropping-off-the-documents-at-the-aramex-courier-office">Dropping off the documents at the Aramex courier office</a></li>
  <li><a href="#visa-processing-and-issuance" id="toc-visa-processing-and-issuance" class="nav-link" data-scroll-target="#visa-processing-and-issuance">Visa processing and issuance</a></li>
  <li><a href="#picking-up-your-passport" id="toc-picking-up-your-passport" class="nav-link" data-scroll-target="#picking-up-your-passport">Picking up your passport</a></li>
  <li><a href="#ending-notes" id="toc-ending-notes" class="nav-link" data-scroll-target="#ending-notes">Ending notes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">My experience applying for the F1 visa in Singapore</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Grad school</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>If you’re an international student heading to the US for graduate school, you’ll probably need an F1 or J1 visa (depending on what your international office has told you). Here I talk about my experience of getting an F1 visa at the US embassy in Singapore as a Singaporean citizen.</p>
<section id="timeline" class="level1">
<h1>Timeline</h1>
<p>My visa application timeline looked like this:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Date</th>
<th>Event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>~29 Apr</td>
<td>Apply for new passport*</td>
</tr>
<tr class="even">
<td>3 May</td>
<td>Passport ready for collection*</td>
</tr>
<tr class="odd">
<td>10 May</td>
<td>Collect new passport at post office*</td>
</tr>
<tr class="even">
<td>10 May</td>
<td>Apply for I-20 form</td>
</tr>
<tr class="odd">
<td>23 May</td>
<td>Receive I-20 form electronically from MIT international students’ office</td>
</tr>
<tr class="even">
<td>24 May</td>
<td>Complete application for F1 visa (DS-160 application form)</td>
</tr>
<tr class="odd">
<td>24 May</td>
<td>Paid for I-901/SEVIS fee and MRV fee</td>
</tr>
<tr class="even">
<td>27 May</td>
<td>Applied for a visa interview appointment and granting of interview waiver</td>
</tr>
<tr class="odd">
<td>28 May</td>
<td>Dropped off documents at Aramex courier office</td>
</tr>
<tr class="even">
<td>5 Jun</td>
<td>Visa issued</td>
</tr>
<tr class="odd">
<td>6 Jun</td>
<td>Picked up passport (with visa) from Aramex courier office</td>
</tr>
</tbody>
</table>
<p>*Optional steps</p>
<p>Total time: 39 calendar days</p>
<p>How long it takes for you will depend on when in the year you apply - wait times for visa interview appointments tend to get really long (~1 month) approaching Jun-Aug, when lots of people are starting school in the US. So it’s really important you <strong>start applying as early as possible</strong> to get your visa in time for the start of school!</p>
<p>You can also refer to the official <a href="https://www.ustraveldocs.com/sg/en/step-1">US Travel Docs website</a> for primary info about the process.</p>
</section>
<section id="total-cost-of-application" class="level1">
<h1>Total cost of application</h1>
<table class="table">
<thead>
<tr class="header">
<th>Description</th>
<th>Cost (SGD)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Passport renewal</td>
<td>70</td>
</tr>
<tr class="even">
<td>I-901/SEVIS fee</td>
<td>480</td>
</tr>
<tr class="odd">
<td>MRV fee</td>
<td>259</td>
</tr>
<tr class="even">
<td><strong>Total</strong></td>
<td><strong>809</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="applying-for-a-new-passport" class="level1">
<h1>Applying for a new passport</h1>
<p>My previous passport was going to expire in 2025, so I decided to apply for a new passport to avoid having to apply for one while in the US. Since I was now applying as an adult, my new passport has a 10-year validity period (rather than a 5-year one), which would comfortably encompass the duration of my PhD studies. I’d recommend doing this to save yourself some inconvenience in the long-term.</p>
<p>Applying for a new passport as a Singaporean in Singapore is easy - just go to the <a href="https://www.ica.gov.sg/documents/passport/apply">ICA website</a> and fill in the necessary details. ICA was really efficient and they had my new passport ready within a week, so I made an appointment to collect my passport at a nearby post office - the earliest I could make my appointment was a week later.</p>
<p>If you do need your passport earlier, though, you can take your chances at going to the <a href="https://www.ica.gov.sg/documents/passport/collect">Passport Unit at the ICA Building</a> directly with your NRIC and old passport. Usually you have to book an appointment to collect at the ICA building, which is not an option offered to everyone who applies for a new passport, so this is not guaranteed to work. However I do know one person who tried this way and they got their passport right away.</p>
<p>I did have to take a new passport photo, but I took it at home using a smartphone and a passport photo application. If possible, have your photo also fulfill <a href="https://travel.state.gov/content/travel/en/us-visas/visa-information-resources/photos.html">US visa photo requirements</a> so you can reuse the same photo.</p>
</section>
<section id="apply-for-i-20-form" class="level1">
<h1>Apply for I-20 form</h1>
<p>The I-20 form is a “Certificate of Eligibility” that is issued by your school as evidence that you are attending the school. You need it to apply for an F1 visa.</p>
<p>The process probably differs between schools - at MIT, the International Students’ Office has a web portal for international students to submit their information and request an I-20. Their website said they take 10-15 business days to issue the I-20, and I indeed received mine after 10 business days. Your school does need your passport information to issue an I-20, so if you’re applying for a new passport, you’ll need to wait for that first before you get your I-20.</p>
</section>
<section id="complete-application-for-f1-visa-ds-160" class="level1">
<h1>Complete application for F1 visa (DS-160)</h1>
<p>The application form for the F1 visa is called a DS-160, which you can access <a href="https://ceac.state.gov/GenNIV/Default.aspx">here</a>. It is also one of the most tedious forms I’ve ever had to fill! Otherwise, it is fairly straightforward to complete. Just fill it in honestly and accurately as possible, and <strong>double check</strong> your responses before submitting!</p>
</section>
<section id="pay-for-i-90sevis-fee" class="level1">
<h1>Pay for I-90/SEVIS fee</h1>
<p>After you complete your application, you’ll need to pay for the I-90 SEVIS fee, which is <a href="https://www.fmjfee.com/i901fee/index.html">on a different website</a>. This step is also pretty straightforward. You should then print out the receipt for your visa application (see below).</p>
</section>
<section id="apply-for-a-visa-interview-appointment-and-getting-an-interview-waiver" class="level1">
<h1>Apply for a visa interview appointment (and getting an interview waiver)</h1>
<p>For Singaporeans, you once again have to <a href="https://portal.ustraveldocs.com/?country=Singapore&amp;language=English">visit a different website</a> to schedule your visa interview. This portal will tell you when is the next closest time you can schedule your interview, and it actually differs from the US Department of State’s <a href="https://travel.state.gov/content/travel/en/us-visas/visa-information-resources/wait-times.html">online appointment wait time tracker</a>. For example, at the point in time when I was scheduling my interview, the State Department’s website said the wait time was 17 calendar days, but the US Travel Docs’ portal said the next appointment was 20 calendar days away. So I would log into the the US Travel Docs portal to get the latest info rather than use the State Department tracker, although it does give a good estimate.</p>
<p>When you apply for the visa interview, you will need to pay US Travel Docs a machine-readable visa (MRV) fee, presumably to cover the cost of producing your visa and the interview. This fee must be paid before you are allowed to schedule an interview. However, they only process the MRV fee during business hours, so if you pay for it on a weekend, you need to wait until 3pm of the next business day for it to be processed (and thus become able to schedule your interview). For example, I actually paid for the MRV fee on 24 May (Fri) evening, but could only schedule my interview on 27 May (Mon) afternoon.</p>
<p>In the end I was actually fortunate to receive a waiver for the visa interview, i.e.&nbsp;I did not have to attend an interview. This is because, as of 1 Jan 2024, the US has a <a href="https://travel.state.gov/content/travel/en/News/visas-news/important-update-on-waivers-of-the-interview-requirement-for-certaing-nonimmigrant-visa-applicants.html">new policy</a> where applicants who meet the following criteria do not have to attend an in-person interview:</p>
<blockquote class="blockquote">
<ul>
<li><p>Were previously issued a nonimmigrant visa in any classification, <strong>unless the only prior issued visa was a B visa</strong> (emphasis mine);</p></li>
<li><p>Are applying within 48 months of their most recent nonimmigrant visa’s expiration date;</p></li>
<li><p>Apply in their country of nationality or residence;</p></li>
<li><p>Have never been refused a visa (unless such refusal was overcome or waived);</p></li>
<li><p>Have no apparent or potential ineligibility</p></li>
</ul>
</blockquote>
<p>In my case, I actually had received a J1 visa about 2 years ago because I had previously been to the US for an exchange programme, which made me eligible for the visa interview waiver. This waiver was granted through the US Travel Docs portal - you have to answer a series of questions which determine whether you can receive a waiver.</p>
<p>Importantly, the US embassy may still call you in for an in-person interview if they deem it necessary, though this did not happen for me.</p>
</section>
<section id="dropping-off-the-documents-at-the-aramex-courier-office" class="level1">
<h1>Dropping off the documents at the Aramex courier office</h1>
<p>After I was granted an interview waiver, I was given instructions to drop off some documents at an Aramex courier office at Bstone Travel, which is a travel agency located in People’s Park Centre. Note that the office is only open during business hours until 5.30pm. At this stage, <strong>be careful to check you are submitting all the required documents</strong>, because they may call you in for an interview if you are lacking some documents.</p>
<p>The documents that I submitted were:</p>
<ul>
<li><p>DS-160 confirmation page (i.e.&nbsp;the page with a barcode you receive after submitting the DS-160)</p></li>
<li><p>My current passport</p></li>
<li><p>My previous passport (as proof of my J1 visa)</p></li>
<li><p>Drop-box submission letter (this is the same as the Interview Waiver Confirmation Letter)</p></li>
<li><p>Colour photograph</p></li>
<li><p>Proof of SEVIS payment</p></li>
<li><p>Copy of valid I-20 (you can print the electronic version from your school, then sign on the printed copy)</p></li>
<li><p>Proof of financial statements (I submitted a letter from my school as well as my scholarship agency saying that I was being covered by a scholarship)</p></li>
<li><p>My CV</p></li>
</ul>
<p>When you get to Bstone Travel, there is a counter with a sign indicating US visa drop off, and you can simply pass your documents to the employee at the counter. There is no fee you have to pay at drop off. The employee will issue you a receipt with a tracking number for your documents, and that’s it. You can then enter this tracking number on the <a href="https://www.aramex.com/ar/en">Aramex website</a> to see when your documents have been delivered to the US embassy - I believe mine were delivered 1-2 days after I dropped them off.</p>
</section>
<section id="visa-processing-and-issuance" class="level1">
<h1>Visa processing and issuance</h1>
<p>After you drop off your visa documents, there is actually a <a href="https://ceac.state.gov/CEACStatTracker/Status.aspx?">State Department website</a> that lets you track the progress of your visa application, but in my experience the status of my visa wasn’t updated at all on this website so it was useless.</p>
<p>My visa took about 1 week to be issued after I dropped off my documents at Aramex, which was a lot faster than I expected. I received an email and a text message from Aramex saying that my passport was ready for collection. Additionally, when I checked the State Department visa tracker, it was now updated to say that my visa had been issued.</p>
<p>From friends who did have to do an interview, their visas were also issued within a week of the interview, so the turnover time does seem to be quite short.</p>
<p>There might be a case where you need to travel overseas (e.g.&nbsp;you had booked a vacation some time ago), but your passport is still with the embassy. I actually had a concern about this happening to me as I had a trip planned in July, though fortunately my visa was issued in time. If this issue does happen to you, the <a href="https://www.ustraveldocs.com/sg/en/general-information/#faqs">US Travel Docs website</a> says you can contact their helpline to request a temporary return of your passport.</p>
</section>
<section id="picking-up-your-passport" class="level1">
<h1>Picking up your passport</h1>
<p>My passport could be picked up from courier office at Bstone Travel. Note that Aramex stipulates that you need to pick up your passport <a href="https://www.aramex.com/us/en/track-your-passport-from-the-us-embassy/detail?contentId=b8097088-b3f2-659d-9310-ff0100e7fe0c&amp;module=faqs&amp;page=0">within 15 business days</a> of getting the notice of it being ready. I actually asked my mom to help me pick up my passport as I was busy at work the entire week – I probably could have picked it up on my own the next week, but I was pretty anxious to get my passport back.</p>
<p>If you want to ask someone else to pick up your passport on your behalf (only a spouse, parent, or child), they will need to bring along:</p>
<ul>
<li><p>Their own IC</p></li>
<li><p>A copy of your IC</p></li>
<li><p>A printed/written hardcopy letter of authorization (as proof that you gave the person permission to collect your passport)</p></li>
</ul>
<p>I also gave my mom the Interview Waiver Confirmation Letter and the drop off receipt just in case the staff asked for it.</p>
<p>For the letter of authorization, I just followed some templates that Aramex had posted online:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="letter of authorisation.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="533"></p>
</figure>
</div>
</section>
<section id="ending-notes" class="level1">
<h1>Ending notes</h1>
<p>And that’s it! The entire application process was surprisingly efficient, although I suspect this was because I was privileged to be a Singaporean citizen and also had a previous US visa. Your best resource is really going to be your school’s international student office, so do reach out to them if you face any hiccups in your visa application process.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>